<!-- required: user, loggedUser, isOwner, isFollowing, displayMode -->

<div class="profile-card <%= displayMode %>">

    <% if (displayMode !== "full") { %>
    <a href="/profile/<%= user.userID %>" class="profile-card-link">
    <% } %>

    <div class="profile-top">
        
        <!-- AVATAR -->
        <img class="profile-avatar" 
            src="<%= user.profileImageUrl || '/img/default-avatar.png' %>" 
            alt="Profile Picture">

        <!-- DETAILS -->
        <div class="profile-details">
            <% if (!user.firstName || !user.lastName) { %>
                <h1 class="main-title"><%= user.username %></h1>
            <% } else { %>
                <h1 class="main-title"><%= user.firstName %> <%= user.lastName %></h1>
            <% } %>
            <h3 class="sub-title">@<%= user.username %></h3>
        </div>

        <!-- FOLLOW / UNFOLLOW BUTTON -->
        <% if (displayMode !== 'tiny' && loggedUser && !isOwner) { %>
        <div class="profile-action" style="margin-left:auto;">
            <% if (isFollowing) { %>
                <form action="/follow/<%= user.userID %>?_method=DELETE" method="POST">
                    <button type="submit" class="submit-btn btn-danger">
                        Unfollow
                    </button>
                </form>
            <% } else { %>
                <form action="/follow/<%= user.userID %>" method="POST">
                    <button type="submit" class="submit-btn">
                        Follow
                    </button>
                </form>
            <% } %>
        </div>
        <% } %>

    </div>

    <% if (displayMode !== "full") { %>
    </a>
    <% } %>

    <!-- STATS (ONLY FULL MODE) -->
    <% if (displayMode === "full") { %>
    <div class="profile-stats">

        <a href="/profile/<%= user.userID %>?view=followers">
            <strong><%= user.followersCount ?? followers?.length %></strong> Followers
        </a>

        <a href="/profile/<%= user.userID %>?view=following">
            <strong><%= user.followingCount ?? following?.length %></strong> Following
        </a>

        <a href="/profile/<%= user.userID %>?view=runs">
            <strong><%= user.runsCount ?? runs?.length %></strong> Runs
        </a>

    </div>
    <% } %>

</div>
